<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
        <meta name="format-detection" content="telephone=no, email=no"/>
        <meta name="apple-mobile-web-app-capable" content="yes"/>
        <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
        <link rel="stylesheet" type="text/css" href="css/xingXing.css"/>
        <script src="js/jquery-3.1.1.js" type="text/javascript" charset="utf-8"></script>
        <script src="js/html2canvas.js" type="text/javascript" charset="utf-8"></script>
		<title></title>
	</head>
	<body>
		<header id="mj_header5">
			<a onclick="window.history.back()"><</a>
			<span>星星吧</span>
			<p><img src="images/3_03.png"/></p>
		</header>
		<main id="mj_main5">
			<p>【红豆的童话】经典人物大pk</p>
			<div class="mj_butImg">
				<p><img src="images/m.jpg"/>皮皮虾我们走<span>LV8</span></p>
				<span>+关注</span>
			</div>
			<p class="mj_ju"><img src="images/3_06.png"/></p>
			<p class="mj_foo">
				<span>回复楼主/已有345条回复</span>
				<span><img src="images/1_21.png"/></span>
			</p>
		</main>
		<footer id="mj_footer5">
			<ul>
				<li>
					<img src="images/4_05.png"/>
					<p class="mj_top">收藏</p>
					<p class="mj_tom" style="color: #E2368E;">小</p>
				</li>
				<li>
					<img src="images/4_07.png"/>
					<p class="mj_top">瞬间移动</p>
					<p class="mj_tom">中</p>
				</li>
				<li>
					<img src="images/4_09.png"/>
					<p class="mj_top">举报</p>
					<p class="mj_tom">大</p>
				</li>
				<li>
					<img src="images/4_11.png"/>
					<p class="mj_top">分享</p>
					<p class="mj_tom">特大</p>
				</li>
			</ul>
			<div id="mj_move">
				<p id="mj_pM"></p>
				<p id="mj_circle"></p>
			</div>
			<p>取消</p>
		</footer>
		<script type="text/javascript">
		var hgt = document.documentElement.clientHeight;
		var bod = document.getElementsByTagName("body")[0];
		bod.style.height = hgt+"px";
		
			$("#mj_header5 p").click(function(){
				$("#mj_footer5").slideDown();
			})
			$("#mj_footer5>p").click(function(){
				$("#mj_footer5").slideUp();
			})
			
		//图片
			var flang="<p id='mj_create1'><a href='xingXing.html'><</a><span><u id='mj_number'>1</u>/4</span><span onclick='cun()'>保存</span></p><p id='mj_create2'>查看原图</p>";
			$(".mj_ju img").click(function(){
				$(".mj_ju").css({"width":"100%","height":"99.5%","position":"absolute","z-index":"2","top":"0","padding":"0"});
				$(this).css({"width":"100%","height":"100%"});
				$(".mj_ju").append(flang);
				flang ="";
				$("#mj_create2").click(function(){
					window.location.href="xingXing.html";
				})
			})
		//保存
		function cun(){
			html2canvas(document.body, { 
				allowTaint: true,
				taintTest: false,
				onrendered: function(canvas) {
					canvas.id = "mycanvas";
					document.body.appendChild(canvas); //生成base64图片数据
					var dataUrl =canvas.toDataURL("image/png"); //把canvas中的图片变成data:image
					var newImg = document.createElement("img");
					newImg.src = dataUrl;
					//document.body.appendChild(newImg);
					
					
					
					/*string filepath = "";
					string imgData = Request["url"].ToString();
					var date = DateTime.Now.ToString("yyyyMMddmsms");
					if (imgData.StartsWith("data:image/png;base64") == true){
						var base64 = imgData.Substring(22);
						byte[] bytes = Convert.FromBase64String(base64);
						MemoryStream memStream = new MemoryStream(bytes);
						BinaryFormatter binFormatter = new BinaryFormatter();
						var img = System.Drawing.Image.FromStream(memStream);
						filepath = "~/images/output/" + date + ".png";
						if (!Directory.Exists(Server.MapPath("~/images/output"))){
							Directory.CreateDirectory(Server.MapPath("~/images/output"));
						}
						img.Save(Server.MapPath(filepath));
					}*/
				//Download()
				
				
				
					/*var image = new Image();
					image.src = canvas.toDataURL("image/png");
					return image;*/
				}
			});
		
		}

		//亮度条	
			$("#mj_circle").mousedown(function(e){
				var a=e.clientX-$("#mj_circle").offset().left;
				$("#mj_move")[0].onmousemove=function(e){
					var x=e.clientX-a-40;
					$("#mj_circle")[0].style.left=x+"px";
					$("#mj_pM").stop().animate({"width":x+"px"});
					//alert($("#mj_move").width())
					if(x<=82){
						
						$(".mj_tom").css({"color":"#333"});
						$(".mj_tom").eq(0).css({"color":"#E2368E"});
						
					}else if(x<=164 && x>82){
						
						$(".mj_tom").css({"color":"#333"});
						$(".mj_tom").eq(1).css({"color":"#E2368E"});
						
					}else if(x<=246 && x>164){
						
						$(".mj_tom").css({"color":"#333"});
						$(".mj_tom").eq(2).css({"color":"#E2368E"});
						
					}else if(x<=330 && x>246){
						
						$(".mj_tom").css({"color":"#333"});
						$(".mj_tom").eq(3).css({"color":"#E2368E"});
					}
				}
			})
			document.onmouseup=function(){
				document.onmousemove=document.onmousedown=null;
			}
		</script>
	</body>
</html>
